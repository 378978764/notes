<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 8.3.2 Beta1 (457478)"/><meta name="author" content="盛迪"/><meta name="created" content="2018-12-26 03:33:40 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2018-12-27 03:01:49 +0000"/><meta name="content-class" content="yinxiang.markdown"/><title>阵列信号处理作业</title></head><body><div style="font-size: 14px; margin: 0; padding: 0; width: 100%;"><h1 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 41px; border-bottom: 3px double #999; color: #000; margin-top: 14px;">阵列信号处理作业</h1>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">目录：</p>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">结果</h2>
<div style="line-height: 160%; box-sizing: content-box;"><ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;"><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">阵列信号处理作业
</a><ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;"><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">结果
</a><ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;"><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">失配广义夹角
</a></li><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">Grating Lobe
</a></li></ul></li><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">代码
</a><ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333; margin-top: 0; margin-bottom: 0;"><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">失配广义夹角
</a></li><li style="line-height: 160%; box-sizing: content-box; position: relative;"><a style="line-height: 160%; box-sizing: content-box; text-decoration: underline; color: #5286bc;">GratingLobe
</a></li></ul></li></ul></li></ul></div><h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">失配广义夹角</h3>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">课本上的图是三种：<br/>
<img src="%E9%98%B5%E5%88%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E4%BD%9C%E4%B8%9A.resources/CA55FF6D-8BE8-482D-9B50-0278209C5DF4.png" height="498" width="810"/></p>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">五种的如下:<br/>
<img src="%E9%98%B5%E5%88%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E4%BD%9C%E4%B8%9A.resources/138B4D24-4727-4135-BCB0-CF61F64DE09B.png" height="493" width="560"/><br/>
五种波束形成器失配广义夹角随输入信噪比的变化比较<br/>
如果我们动态修改生成信号和噪声的<code style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;">n</code>的话，有下面这个动态图：<br/>
<img src="%E9%98%B5%E5%88%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E4%BD%9C%E4%B8%9A.resources/angle.gif" height="420" width="560"/><br/>
可以发现，<code style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;">mb</code>和<code style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;">rmi</code>比较稳定，其他的波动较大。</p>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">Grating Lobe</h3>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;">
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333; margin-top: 0; margin-bottom: 0;">讨论当阵元间隔大于半波长时，为什么会出现栅瓣？</p>
</blockquote>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">均匀线性阵列当阵元间距大于波长的一半时，会出现栅瓣，导致空间模糊。</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">对于阵元数一定的等距线阵，要想增大阵列有效孔径就必须加大阵元 间距，但当阵元间距超过入射信号波长的一半时会产生栅瓣而出现信号波 达方向估计多值模糊问题</li>
</ul>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">推导过程，参考课本上的论述：<br/>
1、首先抽象出一个非等距线阵：<br/>
<img src="%E9%98%B5%E5%88%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E4%BD%9C%E4%B8%9A.resources/59D12267-72CB-4BB4-A532-38732C2E305D.png" height="357" width="776"/><br/>
2、得到阵列流形矢量：<br/>
<img src="%E9%98%B5%E5%88%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E4%BD%9C%E4%B8%9A.resources/069F7739-1709-4109-9364-DCCB09811FD2.png" height="70" width="395"/><br/>
令红框中的两个相等，得到：<br/>
<img src="%E9%98%B5%E5%88%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E4%BD%9C%E4%B8%9A.resources/2B3E76F6-4FB2-4A89-94D4-6C2838857043.png" height="34" width="323"/><br/>
变更一下等价形式：<br/>
<img src="%E9%98%B5%E5%88%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E4%BD%9C%E4%B8%9A.resources/E25A7875-2125-4BD9-8FF6-8C440D2BBBD0.png" height="32" width="452"/><br/>
3、一般的形式：<br/>
<img src="%E9%98%B5%E5%88%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E4%BD%9C%E4%B8%9A.resources/11D04B31-1FF4-4916-B72C-AA3E8960A493.png" height="84" width="377"/><br/>
当其阵元间距大于等于半个信号波长时，这个式子有很多解。因此此时存在信号波达方向估计的二值模糊问题。</p>
<blockquote style="line-height: 160%; box-sizing: content-box; margin: 15px 0; border-left: 4px solid #ddd; padding: 0 15px; color: #777;">
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333; margin-top: 0; margin-bottom: 0;">因此，对于 L 元等距线阵，要想不存在信号波达方向估计的二值模糊问题，其空间孔径最大值应小于<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0;   overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 0.872331em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 1.217331em; vertical-align: -0.345em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; width: .12em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-table; table-layout: fixed; margin-right: -2px; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-row; text-align: center; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 0.872331em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -2.6550000000000002em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 3em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .7em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">2</span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -3.15em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 3em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; width: 100%; position: relative; overflow: hidden; display: inline-block; height: 0.2em; -ms-high-contrast-adjust: none;"><img style="width: 100%;" src="data:image/svg+xml;charset=utf8,%3Csvg%20width%3D%22400em%22%20height%3D%220.2em%22%20viewbox%3D%220%200%20400000%20200%22%20preserveaspectratio%3D%22xMinYMin%20slice%22%20style%3D%22display%3A%20block%3B%20position%3A%20absolute%3B%20width%3A%20100%25%3B%20fill%3A%20currentColor%3B%20stroke%3A%20currentColor%3B%20fill-rule%3A%20nonzero%3B%20fill-opacity%3A%201%3B%20stroke-width%3A%201%3B%20stroke-linecap%3A%20butt%3B%20stroke-linejoin%3A%20miter%3B%20stroke-miterlimit%3A%204%3B%20stroke-dasharray%3A%20none%3B%20stroke-dashoffset%3A%200%3B%20stroke-opacity%3A%201%3B%20line-height%3A%20160%25%3B%20box-sizing%3A%20content-box%3B%20-ms-high-contrast-adjust%3A%20none%3B%22%3E%3Cpath%20d%3D%22M0%2080H400000%20v40H0z%20M0%2080H400000%20v40H0z%22%20style%3D%22line-height%3A%20160%25%3B%20box-sizing%3A%20content-box%3B%20stroke%3A%20none%3B%20-ms-high-contrast-adjust%3A%20none%3B%22%2F%3E%3C%2Fsvg%3E"/></span></span><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -3.394em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 3em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .7em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">L</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">−</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">1</span></span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; font-size: 1px;  -ms-high-contrast-adjust: none;">​</span></span><span style="line-height: 160%; box-sizing: content-box; display: table-row; text-align: center; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 0.345em; -ms-high-contrast-adjust: none;"/></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; width: .12em; -ms-high-contrast-adjust: none;"/></span></span></span></span>个信号波长。</p>
</blockquote>
<p style="line-height: 160%; box-sizing: content-box; margin: 10px 0; color: #333;">使用<code style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; color: #c1788b; padding: 4px 4px 2px 0; letter-spacing: -.3px;">MPDR</code>波束形成器进行测试:</p>
<ul style="line-height: 160%; box-sizing: content-box; display: block; list-style-type: disc; padding-left: 30px; margin: 6px 0 10px; color: #333;">
<li style="line-height: 160%; box-sizing: content-box; position: relative;">第一次保护5°，抑制20°和-66°</li>
<li style="line-height: 160%; box-sizing: content-box; position: relative;">第一次保护5°，抑制20°和-65.9°<br/>
因为我们知道<span style="font: normal 1.21em KaTeX_Main,Times New Roman,serif; white-space: nowrap; text-indent: 0; text-rendering: auto; line-height: 160%; box-sizing: content-box;"><span style="line-height: 160%; box-sizing: content-box; clip: rect(1px,1px,1px,1px); padding: 0; border: 0;   overflow: hidden; position: fixed; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 1.08945em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; display: inline-block; height: 1.08945em; vertical-align: 0em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; position: relative; display: inline-block; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">e</span><span style="line-height: 160%; box-sizing: content-box; text-align: left; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-table; table-layout: fixed; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-row; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 1.08945em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -3.363em; margin-right: 0.05em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 3em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .7em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.05724em; -ms-high-contrast-adjust: none;">j</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; width: .12em; font-size: 1.42857143em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-table; table-layout: fixed; margin-right: -2px; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-row; text-align: center; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 1.0377857142857143em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -2.656em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 3em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .71428571em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">λ</span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -3.1275em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 3em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; width: 100%; position: relative; overflow: hidden; display: inline-block; height: 0.245em; -ms-high-contrast-adjust: none;"><img style="width: 100%;" src="data:image/svg+xml;charset=utf8,%3Csvg%20width%3D%22400em%22%20height%3D%220.245em%22%20viewbox%3D%220%200%20400000%20200%22%20preserveaspectratio%3D%22xMinYMin%20slice%22%20style%3D%22display%3A%20block%3B%20position%3A%20absolute%3B%20width%3A%20100%25%3B%20fill%3A%20currentColor%3B%20stroke%3A%20currentColor%3B%20fill-rule%3A%20nonzero%3B%20fill-opacity%3A%201%3B%20stroke-width%3A%201%3B%20stroke-linecap%3A%20butt%3B%20stroke-linejoin%3A%20miter%3B%20stroke-miterlimit%3A%204%3B%20stroke-dasharray%3A%20none%3B%20stroke-dashoffset%3A%200%3B%20stroke-opacity%3A%201%3B%20line-height%3A%20160%25%3B%20box-sizing%3A%20content-box%3B%20-ms-high-contrast-adjust%3A%20none%3B%22%3E%3Cpath%20d%3D%22M0%2080H400000%20v40H0z%20M0%2080H400000%20v40H0z%22%20style%3D%22line-height%3A%20160%25%3B%20box-sizing%3A%20content-box%3B%20stroke%3A%20none%3B%20-ms-high-contrast-adjust%3A%20none%3B%22%2F%3E%3C%2Fsvg%3E"/></span></span><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -3.5020714285714285em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 3em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .71428571em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">2</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.03588em; -ms-high-contrast-adjust: none;">π</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">d</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.24533333333333335em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">sin</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">(</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">5</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">)</span></span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; font-size: 1px;  -ms-high-contrast-adjust: none;">​</span></span><span style="line-height: 160%; box-sizing: content-box; display: table-row; text-align: center; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 0.344em; -ms-high-contrast-adjust: none;"/></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; width: .12em; font-size: 1.42857143em; -ms-high-contrast-adjust: none;"/></span></span></span></span></span></span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.2777777777777778em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">≈</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.2777777777777778em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">e</span><span style="line-height: 160%; box-sizing: content-box; text-align: left; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-table; table-layout: fixed; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-row; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 1.08945em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -3.363em; margin-right: 0.05em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 3em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .7em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.05724em; -ms-high-contrast-adjust: none;">j</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; width: .12em; font-size: 1.42857143em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-table; table-layout: fixed; margin-right: -2px; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-row; text-align: center; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 1.0377857142857143em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -2.656em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 3em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .71428571em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">λ</span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -3.1275em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 3em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; width: 100%; position: relative; overflow: hidden; display: inline-block; height: 0.245em; -ms-high-contrast-adjust: none;"><img style="width: 100%;" src="data:image/svg+xml;charset=utf8,%3Csvg%20width%3D%22400em%22%20height%3D%220.245em%22%20viewbox%3D%220%200%20400000%20200%22%20preserveaspectratio%3D%22xMinYMin%20slice%22%20style%3D%22display%3A%20block%3B%20position%3A%20absolute%3B%20width%3A%20100%25%3B%20fill%3A%20currentColor%3B%20stroke%3A%20currentColor%3B%20fill-rule%3A%20nonzero%3B%20fill-opacity%3A%201%3B%20stroke-width%3A%201%3B%20stroke-linecap%3A%20butt%3B%20stroke-linejoin%3A%20miter%3B%20stroke-miterlimit%3A%204%3B%20stroke-dasharray%3A%20none%3B%20stroke-dashoffset%3A%200%3B%20stroke-opacity%3A%201%3B%20line-height%3A%20160%25%3B%20box-sizing%3A%20content-box%3B%20-ms-high-contrast-adjust%3A%20none%3B%22%3E%3Cpath%20d%3D%22M0%2080H400000%20v40H0z%20M0%2080H400000%20v40H0z%22%20style%3D%22line-height%3A%20160%25%3B%20box-sizing%3A%20content-box%3B%20stroke%3A%20none%3B%20-ms-high-contrast-adjust%3A%20none%3B%22%2F%3E%3C%2Fsvg%3E"/></span></span><span style="line-height: 160%; box-sizing: content-box; display: block; height: 0; position: relative; top: -3.5020714285714285em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: inline-block; overflow: hidden; width: 0; height: 3em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; display: inline-block; font-size: .71428571em; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">2</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; margin-right: 0.03588em; -ms-high-contrast-adjust: none;">π</span><span style="line-height: 160%; box-sizing: content-box; font-family: KaTeX_Math; font-style: italic; -ms-high-contrast-adjust: none;">d</span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; border: 0 solid; position: relative; margin-right: 0.24533333333333335em; -ms-high-contrast-adjust: none;"/><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">sin</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">(</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">−</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">6</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">5</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">.</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">9</span><span style="line-height: 160%; box-sizing: content-box; -ms-high-contrast-adjust: none;">)</span></span></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; font-size: 1px;  -ms-high-contrast-adjust: none;">​</span></span><span style="line-height: 160%; box-sizing: content-box; display: table-row; text-align: center; -ms-high-contrast-adjust: none;"><span style="line-height: 160%; box-sizing: content-box; display: table-cell; vertical-align: bottom; position: relative; height: 0.344em; -ms-high-contrast-adjust: none;"/></span></span></span><span style="line-height: 160%; box-sizing: content-box; display: inline-block; width: .12em; font-size: 1.42857143em; -ms-high-contrast-adjust: none;"/></span></span></span></span></span></span></span></span></span></span></span></span>，因此会形成两个增益为1的波峰，结果如下：<br/>
<img src="%E9%98%B5%E5%88%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E4%BD%9C%E4%B8%9A.resources/Snipaste_2018-12-27_10-55-27.png" height="489" width="1122"/></li>
</ul>
<h2 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 34px; border-bottom: 1px solid #dbdbdb; color: #333;">代码</h2>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">失配广义夹角</h3>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;">clear all;
clc;
L=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">8</span>;
K=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">20</span>;
M=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">3</span>;
d=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>;
theta0=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;
theta1=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-45</span>;
theta2=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">45</span>;
snr=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-10</span>:<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">30</span>;
sir1=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-30</span>;
sir2=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-30</span>;

pic_num = <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;

<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span> nMax = <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">10</span>:<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">10</span>:<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">500</span>
    fprintf(<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'正在计算n=%d\n'</span>, nMax)
    <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span> m=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>:<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">length</span>(snr) 
        osinr_mpdr(m)=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;
        theta_smi(m)=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;
        theta_rmi(m)=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;
        theta_dl(m)=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;
        theta_sip(m)=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;
        theta_mb(m)=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>;
        sigma=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;
        sigma0=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">10</span>^(snr(m)/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">20</span>)*sigma;
        sigma1=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">10</span>^((snr(m)-sir1)/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">20</span>)*sigma;
        sigma2=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">10</span>^((snr(m)-sir2)/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">20</span>)*sigma;
        a0=(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">exp</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span><span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>*d*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sin</span>(theta0*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>)*(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>:L<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>)))';
        b0=(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">exp</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span><span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>*d*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sin</span>((theta0+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>)*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>)*(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>:L<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>)))';
        b01=(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">exp</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span><span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>*d*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sin</span>((theta0+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span><span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>)*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>)*(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>:L<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>)))';
        b02=(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">exp</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span><span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>*d*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sin</span>((theta0+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>)*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>)*(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>:L<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>)))';
        a1=(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">exp</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span><span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>*d*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sin</span>(theta1*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>)*(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>:L<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>)))';
        a2=(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">exp</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span><span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>*d*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sin</span>(theta2*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>)*(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>:L<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>)))';
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span> n=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>:nMax   
            st0=(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,K)+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span><span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,K))/<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sqrt</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>)*sigma0;
            st1=(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,K)+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span><span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,K))/<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sqrt</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>)*sigma1;
            st2=(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,K)+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span><span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,K))/<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sqrt</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>)*sigma2;
            nt=(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(L,K)+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span><span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(L,K))/<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sqrt</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>)*sigma;
            xt=a0*st0+a1*st1+a2*st2+nt;
            Rxx=a0*a0'*sigma0^<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>+a1*a1'*sigma1^<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>+a2*a2'*sigma2^<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>+<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">eye</span>(L)*sigma^<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>;
            Rin=a1*a1'*sigma1^<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>+a2*a2'*sigma2^<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>+<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">eye</span>(L)*sigma^<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>;
            sRxx=xt*xt'/K;
            [eive,eiva]=eig(sRxx);
            [temp,order]=<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sort</span>(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">diag</span>(eiva));
            sigma_e=<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sqrt</span>(sum(temp(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>:L-M)/(L-M<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>)));
            Us=eive(:,order(L-M+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>:L));
            Rin_e=a1*a1'/(a1'*inv(sRxx)*a1)+a2*a2'/(a2'*inv(sRxx)*a2)+sigma_e^<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">eye</span>(L);

            w_mpdr=inv(Rxx)*a0/(a0'*inv(Rxx)*a0);
            w_smi=inv(sRxx)*b0/(b0'*inv(sRxx)*b0);
            w_rmi=inv(Rin_e)*b0/(b0'*inv(Rin_e)*b0);
            w_dl=inv(sRxx+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">10</span>*sigma_e*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">eye</span>(L))*b0/(b0'*inv(sRxx+<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">10</span>*sigma_e*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">eye</span>(L))*b0);
            w_sip=inv(sRxx)*Us*Us'*b0;
            w_mb=inv(sRxx)*[b0,b01,b02]*inv([b0,b01,b02]'*inv(sRxx)*[b0,b01,b02])*[<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>]';

            theta_smi(m)=theta_smi(m)+<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">acos</span>(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">abs</span>((inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*Rxx*w_smi)'*(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*a0))/(norm(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*Rxx*w_smi)*norm(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*a0)))*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>/<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>;
            theta_rmi(m)=theta_rmi(m)+<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">acos</span>(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">abs</span>((inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*Rxx*w_rmi)'*(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*a0))/(norm(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*Rxx*w_rmi)*norm(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*a0)))*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>/<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>;
            theta_dl(m)=theta_dl(m)+<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">acos</span>(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">abs</span>((inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*Rxx*w_dl)'*(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*a0))/(norm(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*Rxx*w_dl)*norm(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*a0)))*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>/<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>;
            theta_sip(m)=theta_sip(m)+<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">acos</span>(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">abs</span>((inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*Rxx*w_sip)'*(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*a0))/(norm(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*Rxx*w_sip)*norm(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*a0)))*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>/<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>;
            theta_mb(m)=theta_mb(m)+<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">acos</span>(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">abs</span>((inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*Rxx*w_mb)'*(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*a0))/(norm(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*Rxx*w_mb)*norm(inv(Rin)^(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.5</span>)*a0)))*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>/<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>;
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">end</span>
        theta_smi(m)=theta_smi(m)/n;
        theta_rmi(m)=theta_rmi(m)/n;
        theta_dl(m)=theta_dl(m)/n;
        theta_sip(m)=theta_sip(m)/n;
        theta_mb(m)=theta_mb(m)/n;
    <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">end</span>

    <span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">plot</span>(snr,theta_smi);
    <span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">hold</span> on
    <span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">plot</span>(snr,theta_rmi,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'r'</span>);
    <span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">plot</span>(snr,theta_dl,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'k'</span>);
    <span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">plot</span>(snr,theta_sip,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'g'</span>);
    <span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">plot</span>(snr,theta_mb,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'m'</span>);
    xlabel(<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'输入信噪比（dB）'</span>);
    ylabel(<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'失配广义夹角（°）'</span>);
    title(sprintf(<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'夹角比较, 取平均%d次'</span>, nMax));
    grid on
    <span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">legend</span>(<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'smi'</span>,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'rmi'</span>,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'dl'</span>,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'sip'</span>,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'mb'</span>);
    <span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">hold</span> off
    
    
    <span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">figure</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>);
    drawnow;
    F=getframe(gcf);
    I=frame2im(F);
    [I,map]=rgb2ind(I,<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">256</span>);
    <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">if</span> pic_num == <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>
        imwrite(I,map,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'angle.gif'</span>,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'gif'</span>, <span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'Loopcount'</span>,<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">inf</span>,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'DelayTime'</span>,<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.2</span>);
    <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">else</span>
        imwrite(I,map,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'angle.gif'</span>,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'gif'</span>,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'WriteMode'</span>,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'append'</span>,<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'DelayTime'</span>,<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.2</span>);
    <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">end</span>
    pic_num = pic_num + <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">end</span>

</code></pre>
<h3 style="line-height: 160%; box-sizing: content-box; font-weight: 700; font-size: 27px; color: #333;">GratingLobe</h3>
<pre style="line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; margin: 2px 0 8px; background-color: #f5f7f8;"><code style="display: block; overflow-x: auto; background: #1e1e1e; line-height: 160%; box-sizing: content-box; border: 0; border-radius: 0; letter-spacing: -.3px; padding: 18px; color: #f4f4f4; white-space: pre-wrap;"><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">function</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">result</span> = <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">GratingLobe</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">()</span></span>
    <span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;">% 绘图窗口序号</span>
    <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">global</span> figure_index;
    figure_index = <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;
    <span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;">% 使用MPDR绘制一个图像</span>
    <span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;">% 参数：</span>
    <span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;">% angle_to_protect: 想要保护的角度</span>
    <span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;">% angle_to_demean1: 想要抑制的角度1</span>
    <span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;">% angle_to_demean2: 想要抑制的角度2</span>
    <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;"><span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">function</span> <span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">draw_MPDR</span><span style="color: #dcdcdc; line-height: 160%; box-sizing: content-box;">(angle_to_protect, angle_to_demean1, angle_to_demean2)</span></span>
        <span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;">% 初始化参数</span>
        L=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">12</span>;
        M=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">3</span>;
        K=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">200</span>;
        d=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;
        snr=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">30</span>;
        inr1=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">30</span>;
        inr2=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">20</span>;
        sigma=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;
        sigma0=sigma*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">10</span>^(snr/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">20</span>);
        sigma1=sigma*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">10</span>^(inr1/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">20</span>);
        sigma2=sigma*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">10</span>^(inr2/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">20</span>);
        theta0=angle_to_protect;
        theta1=angle_to_demean1;
        theta2=angle_to_demean2;
        <span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;">% 计算a</span>
        a0=<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">exp</span>(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>*d*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sin</span>(theta0*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>)*[<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>:L<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>]');
        a1=<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">exp</span>(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>*d*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sin</span>(theta1*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>)*[<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>:L<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>]');
        a2=<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">exp</span>(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>*d*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sin</span>(theta2*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>)*[<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>:L<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>]');
        <span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;">% 生成信号</span>
        st0=(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,K)+<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,K))/<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sqrt</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>)*sigma0;
        st1=(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,K)+<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,K))/<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sqrt</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>)*sigma1;
        st2=(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,K)+<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>,K))/<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sqrt</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>)*sigma2;
        nt=(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(L,K)+<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">randn</span>(L,K))/<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sqrt</span>(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>)*sigma;
        xt=a0*st0+a1*st1+a2*st2+nt;
        Rxx=sigma0^<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*a0*a0'+sigma1^<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*a1*a1'+sigma2^<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*a2*a2'+sigma^<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">eye</span>(L);
        w_mpdr=inv(Rxx)*a0/(a0'*inv(Rxx)*a0);
        doa=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-90</span>:<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0.1</span>:<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">90</span>;
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">for</span>(m=<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>:<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">length</span>(doa))
            am=<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">exp</span>(<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">i</span>*<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">2</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">sin</span>(doa(m)*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">pi</span>/<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">180</span>)*d*[<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">0</span>:L<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-1</span>]');
            bp_mpdr(m)=<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">abs</span>(w_mpdr'*am);
        <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">end</span>
        bp_mpdr=bp_mpdr/<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">max</span>(bp_mpdr);
        <span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">figure</span>(figure_index);
        figure_index = figure_index + <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">1</span>;
        colors = [<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'g'</span>, <span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'b'</span>, <span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'r'</span>];
        <span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">plot</span>(doa,<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">10</span>*<span style="color: #4ec9b0; line-height: 160%; box-sizing: content-box;">log</span>(bp_mpdr), colors(figure_index));
        xlabel(<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'Direction of Arrival（°）'</span>);
        ylabel(<span style="color: #d69d85; line-height: 160%; box-sizing: content-box;">'bp_mpdr (dB)'</span>);
        grid on;
    <span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">end</span>
    <span style="color: #57a64a; font-style: italic; line-height: 160%; box-sizing: content-box;">% 保护5°，抑制20°和-66°</span>
    draw_MPDR(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">5</span>, <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">20</span>, <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-66</span>);
    draw_MPDR(<span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">5</span>, <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">20</span>, <span style="color: #b8d7a3; line-height: 160%; box-sizing: content-box;">-65.9</span>);
<span style="color: #569cd6; line-height: 160%; box-sizing: content-box;">end</span>
</code></pre>
</div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%23%20%E9%98%B5%E5%88%97%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E4%BD%9C%E4%B8%9A%0A%E7%9B%AE%E5%BD%95%EF%BC%9A%0A%23%23%20%E7%BB%93%E6%9E%9C%0A%5Btoc%5D%0A%23%23%23%20%E5%A4%B1%E9%85%8D%E5%B9%BF%E4%B9%89%E5%A4%B9%E8%A7%92%0A%E8%AF%BE%E6%9C%AC%E4%B8%8A%E7%9A%84%E5%9B%BE%E6%98%AF%E4%B8%89%E7%A7%8D%EF%BC%9A%0A!%5B61f7c2becb6024d10d9e2ee31c2d54fb.png%5D(evernotecid%3A%2F%2F5071078B-C2BF-4495-8E85-3A53EE366590%2Fappyinxiangcom%2F17093447%2FENResource%2Fp3840)%0A%0A%E4%BA%94%E7%A7%8D%E7%9A%84%E5%A6%82%E4%B8%8B%3A%0A!%5B42a46980b7045a4cf0a5250684c41d14.png%5D(evernotecid%3A%2F%2F5071078B-C2BF-4495-8E85-3A53EE366590%2Fappyinxiangcom%2F17093447%2FENResource%2Fp3841)%0A%E4%BA%94%E7%A7%8D%E6%B3%A2%E6%9D%9F%E5%BD%A2%E6%88%90%E5%99%A8%E5%A4%B1%E9%85%8D%E5%B9%BF%E4%B9%89%E5%A4%B9%E8%A7%92%E9%9A%8F%E8%BE%93%E5%85%A5%E4%BF%A1%E5%99%AA%E6%AF%94%E7%9A%84%E5%8F%98%E5%8C%96%E6%AF%94%E8%BE%83%0A%E5%A6%82%E6%9E%9C%E6%88%91%E4%BB%AC%E5%8A%A8%E6%80%81%E4%BF%AE%E6%94%B9%E7%94%9F%E6%88%90%E4%BF%A1%E5%8F%B7%E5%92%8C%E5%99%AA%E5%A3%B0%E7%9A%84%60n%60%E7%9A%84%E8%AF%9D%EF%BC%8C%E6%9C%89%E4%B8%8B%E9%9D%A2%E8%BF%99%E4%B8%AA%E5%8A%A8%E6%80%81%E5%9B%BE%EF%BC%9A%0A!%5B694cb6cdef081f8cc912b4c250b26a4c.gif%5D(evernotecid%3A%2F%2F5071078B-C2BF-4495-8E85-3A53EE366590%2Fappyinxiangcom%2F17093447%2FENResource%2Fp3842)%0A%E5%8F%AF%E4%BB%A5%E5%8F%91%E7%8E%B0%EF%BC%8C%60mb%60%E5%92%8C%60rmi%60%E6%AF%94%E8%BE%83%E7%A8%B3%E5%AE%9A%EF%BC%8C%E5%85%B6%E4%BB%96%E7%9A%84%E6%B3%A2%E5%8A%A8%E8%BE%83%E5%A4%A7%E3%80%82%0A%23%23%23%20Grating%20Lobe%0A%3E%20%E8%AE%A8%E8%AE%BA%E5%BD%93%E9%98%B5%E5%85%83%E9%97%B4%E9%9A%94%E5%A4%A7%E4%BA%8E%E5%8D%8A%E6%B3%A2%E9%95%BF%E6%97%B6%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E5%87%BA%E7%8E%B0%E6%A0%85%E7%93%A3%EF%BC%9F%0A%0A-%20%E5%9D%87%E5%8C%80%E7%BA%BF%E6%80%A7%E9%98%B5%E5%88%97%E5%BD%93%E9%98%B5%E5%85%83%E9%97%B4%E8%B7%9D%E5%A4%A7%E4%BA%8E%E6%B3%A2%E9%95%BF%E7%9A%84%E4%B8%80%E5%8D%8A%E6%97%B6%EF%BC%8C%E4%BC%9A%E5%87%BA%E7%8E%B0%E6%A0%85%E7%93%A3%EF%BC%8C%E5%AF%BC%E8%87%B4%E7%A9%BA%E9%97%B4%E6%A8%A1%E7%B3%8A%E3%80%82%0A-%20%E5%AF%B9%E4%BA%8E%E9%98%B5%E5%85%83%E6%95%B0%E4%B8%80%E5%AE%9A%E7%9A%84%E7%AD%89%E8%B7%9D%E7%BA%BF%E9%98%B5%EF%BC%8C%E8%A6%81%E6%83%B3%E5%A2%9E%E5%A4%A7%E9%98%B5%E5%88%97%E6%9C%89%E6%95%88%E5%AD%94%E5%BE%84%E5%B0%B1%E5%BF%85%E9%A1%BB%E5%8A%A0%E5%A4%A7%E9%98%B5%E5%85%83%20%E9%97%B4%E8%B7%9D%EF%BC%8C%E4%BD%86%E5%BD%93%E9%98%B5%E5%85%83%E9%97%B4%E8%B7%9D%E8%B6%85%E8%BF%87%E5%85%A5%E5%B0%84%E4%BF%A1%E5%8F%B7%E6%B3%A2%E9%95%BF%E7%9A%84%E4%B8%80%E5%8D%8A%E6%97%B6%E4%BC%9A%E4%BA%A7%E7%94%9F%E6%A0%85%E7%93%A3%E8%80%8C%E5%87%BA%E7%8E%B0%E4%BF%A1%E5%8F%B7%E6%B3%A2%20%E8%BE%BE%E6%96%B9%E5%90%91%E4%BC%B0%E8%AE%A1%E5%A4%9A%E5%80%BC%E6%A8%A1%E7%B3%8A%E9%97%AE%E9%A2%98%0A%0A%E6%8E%A8%E5%AF%BC%E8%BF%87%E7%A8%8B%EF%BC%8C%E5%8F%82%E8%80%83%E8%AF%BE%E6%9C%AC%E4%B8%8A%E7%9A%84%E8%AE%BA%E8%BF%B0%EF%BC%9A%0A1%E3%80%81%E9%A6%96%E5%85%88%E6%8A%BD%E8%B1%A1%E5%87%BA%E4%B8%80%E4%B8%AA%E9%9D%9E%E7%AD%89%E8%B7%9D%E7%BA%BF%E9%98%B5%EF%BC%9A%0A!%5B7b0ed8e29beaca892e4d46ec71553955.png%5D(evernotecid%3A%2F%2F5071078B-C2BF-4495-8E85-3A53EE366590%2Fappyinxiangcom%2F17093447%2FENResource%2Fp3843)%0A2%E3%80%81%E5%BE%97%E5%88%B0%E9%98%B5%E5%88%97%E6%B5%81%E5%BD%A2%E7%9F%A2%E9%87%8F%EF%BC%9A%0A!%5Bd459d430333af69d4c03633771de27c4.png%5D(evernotecid%3A%2F%2F5071078B-C2BF-4495-8E85-3A53EE366590%2Fappyinxiangcom%2F17093447%2FENResource%2Fp3844)%0A%E4%BB%A4%E7%BA%A2%E6%A1%86%E4%B8%AD%E7%9A%84%E4%B8%A4%E4%B8%AA%E7%9B%B8%E7%AD%89%EF%BC%8C%E5%BE%97%E5%88%B0%EF%BC%9A%0A!%5Bd3cde611572707a0e52c5f10b4964677.png%5D(evernotecid%3A%2F%2F5071078B-C2BF-4495-8E85-3A53EE366590%2Fappyinxiangcom%2F17093447%2FENResource%2Fp3845)%0A%E5%8F%98%E6%9B%B4%E4%B8%80%E4%B8%8B%E7%AD%89%E4%BB%B7%E5%BD%A2%E5%BC%8F%EF%BC%9A%0A!%5B564e4f7ad59c019bce4abb0c5f1fbc66.png%5D(evernotecid%3A%2F%2F5071078B-C2BF-4495-8E85-3A53EE366590%2Fappyinxiangcom%2F17093447%2FENResource%2Fp3846)%0A3%E3%80%81%E4%B8%80%E8%88%AC%E7%9A%84%E5%BD%A2%E5%BC%8F%EF%BC%9A%0A!%5B6ed7c14610ef5ff9cb4bb1777cbbc629.png%5D(evernotecid%3A%2F%2F5071078B-C2BF-4495-8E85-3A53EE366590%2Fappyinxiangcom%2F17093447%2FENResource%2Fp3847)%0A%E5%BD%93%E5%85%B6%E9%98%B5%E5%85%83%E9%97%B4%E8%B7%9D%E5%A4%A7%E4%BA%8E%E7%AD%89%E4%BA%8E%E5%8D%8A%E4%B8%AA%E4%BF%A1%E5%8F%B7%E6%B3%A2%E9%95%BF%E6%97%B6%EF%BC%8C%E8%BF%99%E4%B8%AA%E5%BC%8F%E5%AD%90%E6%9C%89%E5%BE%88%E5%A4%9A%E8%A7%A3%E3%80%82%E5%9B%A0%E6%AD%A4%E6%AD%A4%E6%97%B6%E5%AD%98%E5%9C%A8%E4%BF%A1%E5%8F%B7%E6%B3%A2%E8%BE%BE%E6%96%B9%E5%90%91%E4%BC%B0%E8%AE%A1%E7%9A%84%E4%BA%8C%E5%80%BC%E6%A8%A1%E7%B3%8A%E9%97%AE%E9%A2%98%E3%80%82%0A%3E%20%E5%9B%A0%E6%AD%A4%EF%BC%8C%E5%AF%B9%E4%BA%8E%20L%20%E5%85%83%E7%AD%89%E8%B7%9D%E7%BA%BF%E9%98%B5%EF%BC%8C%E8%A6%81%E6%83%B3%E4%B8%8D%E5%AD%98%E5%9C%A8%E4%BF%A1%E5%8F%B7%E6%B3%A2%E8%BE%BE%E6%96%B9%E5%90%91%E4%BC%B0%E8%AE%A1%E7%9A%84%E4%BA%8C%E5%80%BC%E6%A8%A1%E7%B3%8A%E9%97%AE%E9%A2%98%EF%BC%8C%E5%85%B6%E7%A9%BA%E9%97%B4%E5%AD%94%E5%BE%84%E6%9C%80%E5%A4%A7%E5%80%BC%E5%BA%94%E5%B0%8F%E4%BA%8E%24%5Cfrac%7BL-1%7D%7B2%7D%24%E4%B8%AA%E4%BF%A1%E5%8F%B7%E6%B3%A2%E9%95%BF%E3%80%82%0A%0A%E4%BD%BF%E7%94%A8%60MPDR%60%E6%B3%A2%E6%9D%9F%E5%BD%A2%E6%88%90%E5%99%A8%E8%BF%9B%E8%A1%8C%E6%B5%8B%E8%AF%95%3A%0A-%20%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%BF%9D%E6%8A%A45%C2%B0%EF%BC%8C%E6%8A%91%E5%88%B620%C2%B0%E5%92%8C-66%C2%B0%0A-%20%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%BF%9D%E6%8A%A45%C2%B0%EF%BC%8C%E6%8A%91%E5%88%B620%C2%B0%E5%92%8C-65.9%C2%B0%0A%E5%9B%A0%E4%B8%BA%E6%88%91%E4%BB%AC%E7%9F%A5%E9%81%93%24e%5E%7Bj%5Cfrac%7B2%5Cpi%20d%5Csin(5)%7D%7B%5Clambda%7D%7D%20%5Capprox%20e%5E%7Bj%5Cfrac%7B2%5Cpi%20d%5Csin(-65.9)%7D%7B%5Clambda%7D%7D%24%EF%BC%8C%E5%9B%A0%E6%AD%A4%E4%BC%9A%E5%BD%A2%E6%88%90%E4%B8%A4%E4%B8%AA%E5%A2%9E%E7%9B%8A%E4%B8%BA1%E7%9A%84%E6%B3%A2%E5%B3%B0%EF%BC%8C%E7%BB%93%E6%9E%9C%E5%A6%82%E4%B8%8B%EF%BC%9A%0A!%5Bd0634ad3844d70c1a676bf9d058831d0.png%5D(evernotecid%3A%2F%2F5071078B-C2BF-4495-8E85-3A53EE366590%2Fappyinxiangcom%2F17093447%2FENResource%2Fp3850)%0A%23%23%20%E4%BB%A3%E7%A0%81%0A%23%23%23%20%E5%A4%B1%E9%85%8D%E5%B9%BF%E4%B9%89%E5%A4%B9%E8%A7%92%0A%60%60%60matlab%0Aclear%20all%3B%0Aclc%3B%0AL%3D8%3B%0AK%3D20%3B%0AM%3D3%3B%0Ad%3D0.5%3B%0Atheta0%3D0%3B%0Atheta1%3D-45%3B%0Atheta2%3D45%3B%0Asnr%3D-10%3A30%3B%0Asir1%3D-30%3B%0Asir2%3D-30%3B%0A%0Apic_num%20%3D%201%3B%0A%0Afor%20nMax%20%3D%2010%3A10%3A500%0A%20%20%20%20fprintf('%E6%AD%A3%E5%9C%A8%E8%AE%A1%E7%AE%97n%3D%25d%5Cn'%2C%20nMax)%0A%20%20%20%20for%20m%3D1%3Alength(snr)%20%0A%20%20%20%20%20%20%20%20osinr_mpdr(m)%3D0%3B%0A%20%20%20%20%20%20%20%20theta_smi(m)%3D0%3B%0A%20%20%20%20%20%20%20%20theta_rmi(m)%3D0%3B%0A%20%20%20%20%20%20%20%20theta_dl(m)%3D0%3B%0A%20%20%20%20%20%20%20%20theta_sip(m)%3D0%3B%0A%20%20%20%20%20%20%20%20theta_mb(m)%3D0%3B%0A%20%20%20%20%20%20%20%20sigma%3D1%3B%0A%20%20%20%20%20%20%20%20sigma0%3D10%5E(snr(m)%2F20)*sigma%3B%0A%20%20%20%20%20%20%20%20sigma1%3D10%5E((snr(m)-sir1)%2F20)*sigma%3B%0A%20%20%20%20%20%20%20%20sigma2%3D10%5E((snr(m)-sir2)%2F20)*sigma%3B%0A%20%20%20%20%20%20%20%20a0%3D(exp(1i*2*pi*d*sin(theta0*pi%2F180)*(0%3AL-1)))'%3B%0A%20%20%20%20%20%20%20%20b0%3D(exp(1i*2*pi*d*sin((theta0%2B2)*pi%2F180)*(0%3AL-1)))'%3B%0A%20%20%20%20%20%20%20%20b01%3D(exp(1i*2*pi*d*sin((theta0%2B2-1)*pi%2F180)*(0%3AL-1)))'%3B%0A%20%20%20%20%20%20%20%20b02%3D(exp(1i*2*pi*d*sin((theta0%2B2%2B1)*pi%2F180)*(0%3AL-1)))'%3B%0A%20%20%20%20%20%20%20%20a1%3D(exp(1i*2*pi*d*sin(theta1*pi%2F180)*(0%3AL-1)))'%3B%0A%20%20%20%20%20%20%20%20a2%3D(exp(1i*2*pi*d*sin(theta2*pi%2F180)*(0%3AL-1)))'%3B%0A%20%20%20%20%20%20%20%20for%20n%3D1%3AnMax%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20st0%3D(randn(1%2CK)%2B1i*randn(1%2CK))%2Fsqrt(2)*sigma0%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20st1%3D(randn(1%2CK)%2B1i*randn(1%2CK))%2Fsqrt(2)*sigma1%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20st2%3D(randn(1%2CK)%2B1i*randn(1%2CK))%2Fsqrt(2)*sigma2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20nt%3D(randn(L%2CK)%2B1i*randn(L%2CK))%2Fsqrt(2)*sigma%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20xt%3Da0*st0%2Ba1*st1%2Ba2*st2%2Bnt%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20Rxx%3Da0*a0'*sigma0%5E2%2Ba1*a1'*sigma1%5E2%2Ba2*a2'*sigma2%5E2%2Beye(L)*sigma%5E2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20Rin%3Da1*a1'*sigma1%5E2%2Ba2*a2'*sigma2%5E2%2Beye(L)*sigma%5E2%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20sRxx%3Dxt*xt'%2FK%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%5Beive%2Ceiva%5D%3Deig(sRxx)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%5Btemp%2Corder%5D%3Dsort(diag(eiva))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20sigma_e%3Dsqrt(sum(temp(1%3AL-M)%2F(L-M-1)))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20Us%3Deive(%3A%2Corder(L-M%2B1%3AL))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20Rin_e%3Da1*a1'%2F(a1'*inv(sRxx)*a1)%2Ba2*a2'%2F(a2'*inv(sRxx)*a2)%2Bsigma_e%5E2*eye(L)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20w_mpdr%3Dinv(Rxx)*a0%2F(a0'*inv(Rxx)*a0)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20w_smi%3Dinv(sRxx)*b0%2F(b0'*inv(sRxx)*b0)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20w_rmi%3Dinv(Rin_e)*b0%2F(b0'*inv(Rin_e)*b0)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20w_dl%3Dinv(sRxx%2B10*sigma_e*eye(L))*b0%2F(b0'*inv(sRxx%2B10*sigma_e*eye(L))*b0)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20w_sip%3Dinv(sRxx)*Us*Us'*b0%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20w_mb%3Dinv(sRxx)*%5Bb0%2Cb01%2Cb02%5D*inv(%5Bb0%2Cb01%2Cb02%5D'*inv(sRxx)*%5Bb0%2Cb01%2Cb02%5D)*%5B1%2C1%2C1%5D'%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20theta_smi(m)%3Dtheta_smi(m)%2Bacos(abs((inv(Rin)%5E(0.5)*Rxx*w_smi)'*(inv(Rin)%5E(0.5)*a0))%2F(norm(inv(Rin)%5E(0.5)*Rxx*w_smi)*norm(inv(Rin)%5E(0.5)*a0)))*180%2Fpi%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20theta_rmi(m)%3Dtheta_rmi(m)%2Bacos(abs((inv(Rin)%5E(0.5)*Rxx*w_rmi)'*(inv(Rin)%5E(0.5)*a0))%2F(norm(inv(Rin)%5E(0.5)*Rxx*w_rmi)*norm(inv(Rin)%5E(0.5)*a0)))*180%2Fpi%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20theta_dl(m)%3Dtheta_dl(m)%2Bacos(abs((inv(Rin)%5E(0.5)*Rxx*w_dl)'*(inv(Rin)%5E(0.5)*a0))%2F(norm(inv(Rin)%5E(0.5)*Rxx*w_dl)*norm(inv(Rin)%5E(0.5)*a0)))*180%2Fpi%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20theta_sip(m)%3Dtheta_sip(m)%2Bacos(abs((inv(Rin)%5E(0.5)*Rxx*w_sip)'*(inv(Rin)%5E(0.5)*a0))%2F(norm(inv(Rin)%5E(0.5)*Rxx*w_sip)*norm(inv(Rin)%5E(0.5)*a0)))*180%2Fpi%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20theta_mb(m)%3Dtheta_mb(m)%2Bacos(abs((inv(Rin)%5E(0.5)*Rxx*w_mb)'*(inv(Rin)%5E(0.5)*a0))%2F(norm(inv(Rin)%5E(0.5)*Rxx*w_mb)*norm(inv(Rin)%5E(0.5)*a0)))*180%2Fpi%3B%0A%20%20%20%20%20%20%20%20end%0A%20%20%20%20%20%20%20%20theta_smi(m)%3Dtheta_smi(m)%2Fn%3B%0A%20%20%20%20%20%20%20%20theta_rmi(m)%3Dtheta_rmi(m)%2Fn%3B%0A%20%20%20%20%20%20%20%20theta_dl(m)%3Dtheta_dl(m)%2Fn%3B%0A%20%20%20%20%20%20%20%20theta_sip(m)%3Dtheta_sip(m)%2Fn%3B%0A%20%20%20%20%20%20%20%20theta_mb(m)%3Dtheta_mb(m)%2Fn%3B%0A%20%20%20%20end%0A%0A%20%20%20%20plot(snr%2Ctheta_smi)%3B%0A%20%20%20%20hold%20on%0A%20%20%20%20plot(snr%2Ctheta_rmi%2C'r')%3B%0A%20%20%20%20plot(snr%2Ctheta_dl%2C'k')%3B%0A%20%20%20%20plot(snr%2Ctheta_sip%2C'g')%3B%0A%20%20%20%20plot(snr%2Ctheta_mb%2C'm')%3B%0A%20%20%20%20xlabel('%E8%BE%93%E5%85%A5%E4%BF%A1%E5%99%AA%E6%AF%94%EF%BC%88dB%EF%BC%89')%3B%0A%20%20%20%20ylabel('%E5%A4%B1%E9%85%8D%E5%B9%BF%E4%B9%89%E5%A4%B9%E8%A7%92%EF%BC%88%C2%B0%EF%BC%89')%3B%0A%20%20%20%20title(sprintf('%E5%A4%B9%E8%A7%92%E6%AF%94%E8%BE%83%2C%20%E5%8F%96%E5%B9%B3%E5%9D%87%25d%E6%AC%A1'%2C%20nMax))%3B%0A%20%20%20%20grid%20on%0A%20%20%20%20legend('smi'%2C'rmi'%2C'dl'%2C'sip'%2C'mb')%3B%0A%20%20%20%20hold%20off%0A%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20figure(1)%3B%0A%20%20%20%20drawnow%3B%0A%20%20%20%20F%3Dgetframe(gcf)%3B%0A%20%20%20%20I%3Dframe2im(F)%3B%0A%20%20%20%20%5BI%2Cmap%5D%3Drgb2ind(I%2C256)%3B%0A%20%20%20%20if%20pic_num%20%3D%3D%201%0A%20%20%20%20%20%20%20%20imwrite(I%2Cmap%2C'angle.gif'%2C'gif'%2C%20'Loopcount'%2Cinf%2C'DelayTime'%2C0.2)%3B%0A%20%20%20%20else%0A%20%20%20%20%20%20%20%20imwrite(I%2Cmap%2C'angle.gif'%2C'gif'%2C'WriteMode'%2C'append'%2C'DelayTime'%2C0.2)%3B%0A%20%20%20%20end%0A%20%20%20%20pic_num%20%3D%20pic_num%20%2B%201%3B%0Aend%0A%0A%60%60%60%0A%23%23%23%20GratingLobe%0A%60%60%60matlab%0Afunction%20result%20%3D%20GratingLobe()%0A%20%20%20%20%25%20%E7%BB%98%E5%9B%BE%E7%AA%97%E5%8F%A3%E5%BA%8F%E5%8F%B7%0A%20%20%20%20global%20figure_index%3B%0A%20%20%20%20figure_index%20%3D%201%3B%0A%20%20%20%20%25%20%E4%BD%BF%E7%94%A8MPDR%E7%BB%98%E5%88%B6%E4%B8%80%E4%B8%AA%E5%9B%BE%E5%83%8F%0A%20%20%20%20%25%20%E5%8F%82%E6%95%B0%EF%BC%9A%0A%20%20%20%20%25%20angle_to_protect%3A%20%E6%83%B3%E8%A6%81%E4%BF%9D%E6%8A%A4%E7%9A%84%E8%A7%92%E5%BA%A6%0A%20%20%20%20%25%20angle_to_demean1%3A%20%E6%83%B3%E8%A6%81%E6%8A%91%E5%88%B6%E7%9A%84%E8%A7%92%E5%BA%A61%0A%20%20%20%20%25%20angle_to_demean2%3A%20%E6%83%B3%E8%A6%81%E6%8A%91%E5%88%B6%E7%9A%84%E8%A7%92%E5%BA%A62%0A%20%20%20%20function%20draw_MPDR(angle_to_protect%2C%20angle_to_demean1%2C%20angle_to_demean2)%0A%20%20%20%20%20%20%20%20%25%20%E5%88%9D%E5%A7%8B%E5%8C%96%E5%8F%82%E6%95%B0%0A%20%20%20%20%20%20%20%20L%3D12%3B%0A%20%20%20%20%20%20%20%20M%3D3%3B%0A%20%20%20%20%20%20%20%20K%3D200%3B%0A%20%20%20%20%20%20%20%20d%3D1%3B%0A%20%20%20%20%20%20%20%20snr%3D30%3B%0A%20%20%20%20%20%20%20%20inr1%3D30%3B%0A%20%20%20%20%20%20%20%20inr2%3D20%3B%0A%20%20%20%20%20%20%20%20sigma%3D1%3B%0A%20%20%20%20%20%20%20%20sigma0%3Dsigma*10%5E(snr%2F20)%3B%0A%20%20%20%20%20%20%20%20sigma1%3Dsigma*10%5E(inr1%2F20)%3B%0A%20%20%20%20%20%20%20%20sigma2%3Dsigma*10%5E(inr2%2F20)%3B%0A%20%20%20%20%20%20%20%20theta0%3Dangle_to_protect%3B%0A%20%20%20%20%20%20%20%20theta1%3Dangle_to_demean1%3B%0A%20%20%20%20%20%20%20%20theta2%3Dangle_to_demean2%3B%0A%20%20%20%20%20%20%20%20%25%20%E8%AE%A1%E7%AE%97a%0A%20%20%20%20%20%20%20%20a0%3Dexp(i*2*pi*d*sin(theta0*pi%2F180)*%5B0%3AL-1%5D')%3B%0A%20%20%20%20%20%20%20%20a1%3Dexp(i*2*pi*d*sin(theta1*pi%2F180)*%5B0%3AL-1%5D')%3B%0A%20%20%20%20%20%20%20%20a2%3Dexp(i*2*pi*d*sin(theta2*pi%2F180)*%5B0%3AL-1%5D')%3B%0A%20%20%20%20%20%20%20%20%25%20%E7%94%9F%E6%88%90%E4%BF%A1%E5%8F%B7%0A%20%20%20%20%20%20%20%20st0%3D(randn(1%2CK)%2Bi*randn(1%2CK))%2Fsqrt(2)*sigma0%3B%0A%20%20%20%20%20%20%20%20st1%3D(randn(1%2CK)%2Bi*randn(1%2CK))%2Fsqrt(2)*sigma1%3B%0A%20%20%20%20%20%20%20%20st2%3D(randn(1%2CK)%2Bi*randn(1%2CK))%2Fsqrt(2)*sigma2%3B%0A%20%20%20%20%20%20%20%20nt%3D(randn(L%2CK)%2Bi*randn(L%2CK))%2Fsqrt(2)*sigma%3B%0A%20%20%20%20%20%20%20%20xt%3Da0*st0%2Ba1*st1%2Ba2*st2%2Bnt%3B%0A%20%20%20%20%20%20%20%20Rxx%3Dsigma0%5E2*a0*a0'%2Bsigma1%5E2*a1*a1'%2Bsigma2%5E2*a2*a2'%2Bsigma%5E2*eye(L)%3B%0A%20%20%20%20%20%20%20%20w_mpdr%3Dinv(Rxx)*a0%2F(a0'*inv(Rxx)*a0)%3B%0A%20%20%20%20%20%20%20%20doa%3D-90%3A0.1%3A90%3B%0A%20%20%20%20%20%20%20%20for(m%3D1%3Alength(doa))%0A%20%20%20%20%20%20%20%20%20%20%20%20am%3Dexp(i*2*pi*sin(doa(m)*pi%2F180)*d*%5B0%3AL-1%5D')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20bp_mpdr(m)%3Dabs(w_mpdr'*am)%3B%0A%20%20%20%20%20%20%20%20end%0A%20%20%20%20%20%20%20%20bp_mpdr%3Dbp_mpdr%2Fmax(bp_mpdr)%3B%0A%20%20%20%20%20%20%20%20figure(figure_index)%3B%0A%20%20%20%20%20%20%20%20figure_index%20%3D%20figure_index%20%2B%201%3B%0A%20%20%20%20%20%20%20%20colors%20%3D%20%5B'g'%2C%20'b'%2C%20'r'%5D%3B%0A%20%20%20%20%20%20%20%20plot(doa%2C10*log(bp_mpdr)%2C%20colors(figure_index))%3B%0A%20%20%20%20%20%20%20%20xlabel('Direction%20of%20Arrival%EF%BC%88%C2%B0%EF%BC%89')%3B%0A%20%20%20%20%20%20%20%20ylabel('bp_mpdr%20(dB)')%3B%0A%20%20%20%20%20%20%20%20grid%20on%3B%0A%20%20%20%20end%0A%20%20%20%20%25%20%E4%BF%9D%E6%8A%A45%C2%B0%EF%BC%8C%E6%8A%91%E5%88%B620%C2%B0%E5%92%8C-66%C2%B0%0A%20%20%20%20draw_MPDR(5%2C%2020%2C%20-66)%3B%0A%20%20%20%20draw_MPDR(5%2C%2020%2C%20-65.9)%3B%0Aend%0A%60%60%60%0A</center></body></html>